<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Classical Code</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <div id="container">
        <h1>Input Classical Code Manually</h1>
        <p>Please input the classical code with only one function. Example format:</p>
        <pre>
def addition(left, right):
    return left + right

# Example usage:
left = 4
right = 5
sum_result = addition(left, right)
print(sum_result)
        </pre>
        <textarea id="classical_code" placeholder="Enter classical code here..."></textarea>
        <button onclick="generateCircuit()">Generate Circuit</button>

        <div id="results"></div>
    </div>

    <script>
        function generateCircuit() {
            const classicalCode = document.getElementById('classical_code').value;
            fetch('/generate_circuit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ classical_code: classicalCode })
            })
            .then(response => response.json())
            .then(data => {
                const resultsContainer = document.getElementById('results');
                resultsContainer.innerHTML = ''; // Clear previous results

                for (let key in data.qasm_code) {
                    // Create a container for each result
                    const resultDiv = document.createElement('div');
                    resultDiv.classList.add('result');

                    // Create and append the QASM code block
                    const qasmTitle = document.createElement('h2');
                    qasmTitle.textContent = `QASM 3.0 Code (${key})`;
                    resultDiv.appendChild(qasmTitle);

                    const qasmCodePre = document.createElement('pre');
                    qasmCodePre.textContent = data.qasm_code[key];
                    resultDiv.appendChild(qasmCodePre);

                    // Create and append the circuit image
                    const circuitTitle = document.createElement('h2');
                    circuitTitle.textContent = `Circuit Diagram (${key})`;
                    resultDiv.appendChild(circuitTitle);

                    const circuitImage = document.createElement('img');
                    circuitImage.src = data.circuit_image[key];
                    circuitImage.alt = `Circuit Diagram for ${key}`;
                    resultDiv.appendChild(circuitImage);

                    // Append the resultDiv to the results container
                    resultsContainer.appendChild(resultDiv);
                }

                // Plot the locally simulated images from img_ios
                for (let key in data.img_ios) {
                    const imgTitle = document.createElement('h2');
                    imgTitle.textContent = `Simulation Result (${key})`;
                    resultsContainer.appendChild(imgTitle);

                    const img = document.createElement('img');
                    img.src = data.img_ios[key];
                    img.alt = `Simulation Result for ${key}`;
                    resultsContainer.appendChild(img);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while generating the circuit.');
            });
        }
    </script>
</body>

</html>